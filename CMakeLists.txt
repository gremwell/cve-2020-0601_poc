cmake_minimum_required(VERSION 3.5)

project(cve-2020-0601_poc LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

find_package(OpenSSL)
if(OPENSSL_FOUND)
    message(STATUS "OpenSSL native version " ${OPENSSL_VERSION} " found")

    if (OPENSSL_VERSION VERSION_GREATER 1.0.99)
        message(STATUS "OpenSSL version 1.1 is used")
    else()
        message(STATUS "OpenSSL version prior to 1.1 is used")
    endif()
endif()

set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}")
find_package(CryptoPP REQUIRED)

set(pocSources
    main.cpp
    cve-2020-0601_poc.cpp
    openssl-helper.cpp
    )

set(pocHeaders
    cve-2020-0601_poc.h
    openssl-helper.h
    )

add_executable(cve-2020-0601_poc ${pocSources} ${pocHeaders})

target_link_libraries(cve-2020-0601_poc OpenSSL::SSL OpenSSL::Crypto ${CRYPTOPP_LIBRARIES})
